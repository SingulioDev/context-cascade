digraph Security {
    rankdir=TB;
    compound=true;
    node [shape=box, style=filled, fontname="Arial"];

    start [shape=ellipse, label="Start:\nSecurity Task", fillcolor=lightgreen];
    end [shape=ellipse, label="Complete:\nSecured", fillcolor=green, fontcolor=white];

    subgraph cluster_phase0 {
        label="Phase 0: Expertise Loading";
        fillcolor=lightyellow;
        style=filled;
        p0 [label="Load Security\nExpertise"];
    }

    subgraph cluster_audit {
        label="Audit Phase";
        fillcolor=lightblue;
        style=filled;
        a1 [label="Scan for\nVulnerabilities"];
        a2 [label="Analyze\nRisks"];
        a1 -> a2;
    }

    subgraph cluster_fix {
        label="Remediation Phase";
        fillcolor=lightcoral;
        style=filled;
        f1 [label="Apply\nFixes"];
        f2 [label="Verify\nRemediation"];
        f1 -> f2;
    }

    eval [shape=octagon, label="Security\nGate", fillcolor=orange];

    start -> p0;
    p0 -> a1;
    a2 -> f1;
    f2 -> eval;
    eval -> end [label="pass", color=green];
    eval -> a1 [label="fail", color=red, style=dashed];

    labelloc="t";
    label="Security: Audit & Remediation (v2.1)";
    fontsize=16;
}
